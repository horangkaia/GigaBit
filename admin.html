<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>APC PRO – Compatible License Generator</title>
<style>
  body { background:#111; color:#fff; font-family:Arial; padding:24px }
  .card { background:#222; padding:18px; border-radius:10px; width:700px; margin:auto }
  input,select,button { padding:10px; margin-top:8px; width:100%; border-radius:8px; font-size:14px }
  button { background:#27ae60; border:none; color:#fff; font-weight:bold; cursor:pointer }
  pre { background:#000; padding:10px; border-radius:8px; margin-top:12px; white-space:pre-wrap }
</style>
</head>
<body>
<div class="card">
  <h2>AutoPCare PRO — License Generator (Tampermonkey Format)</h2>

  <label>Owner Password</label>
  <input id="pw" type="password" placeholder="Required">

  <label>Tipe License</label>
  <select id="type">
    <option value="single">single</option>
    <option value="global">global</option>
  </select>

  <label>Durasi (hari)</label>
  <select id="days">
    <option value="30">30 hari</option>
    <option value="180">180 hari</option>
    <option value="365">365 hari</option>
    <option value="9999">Lifetime</option>
  </select>

  <label>HWID (kosongkan untuk wildcard *)</label>
  <input id="hwid">

  <button id="btnGen">Generate</button>

  <pre id="out"></pre>
</div>

<script>
const OWNER_PASSWORD = "Kalikiben1@";
const SECRET_KEY     = "TEST_SECRET_123456"; // HARUS SAMA DENGAN Script Tampermonkey

// HMAC Generator
async function hmac(secret, str){
  const key = await crypto.subtle.importKey(
    "raw", new TextEncoder().encode(secret),
    { name: "HMAC", hash: "SHA-256" },
    false,
    ["sign"]
  );
  const sig = await crypto.subtle.sign("HMAC", key, new TextEncoder().encode(str));
  return Array.from(new Uint8Array(sig)).map(b => b.toString(16).padStart(2,"0")).join("");
}

document.getElementById("btnGen").onclick = async()=>{

  if(document.getElementById("pw").value !== OWNER_PASSWORD){
    alert("Password salah");
    return;
  }

  const type  = document.getElementById("type").value;
  const days  = parseInt(document.getElementById("days").value);
  const hwid  = document.getElementById("hwid").value.trim() || "*";
  const expires = Math.floor(Date.now()/1000) + (days * 86400);

  const payload = { type, hwid, expires };
  const b64 = btoa(JSON.stringify(payload));

  const sig = await hmac(SECRET_KEY, b64);

  const finalKey = `${b64}.${sig}`;
  document.getElementById("out").textContent = finalKey;

  try{ navigator.clipboard.writeText(finalKey); }catch{}
};
</script>
</body>
</html>
